import{h as ot}from"./head.aceb434f.js";import{m as lt,n as Y,J as D,K as nt,q as it,aq as dt,y as rt,ac as ct,N as ut,Q as ht,aY as _t,X as ft,d as _,R as gt,I as G,aH as j,$ as mt,B as pt,_ as O,r as L,o as u,c as h,a7 as vt,aZ as yt,a_ as J,b as n,F as I,h as N,a9 as b,w as K,j as f,ax as kt,a2 as Q,aa as Z,p as bt,k as Lt}from"./index.10d6f7a6.js";import{u as Ct}from"./use-refs.84b02192.js";const[Rt,w]=lt("rate");function wt(t,s,r,g){return t>=s?{status:"full",value:1}:t+.5>=s&&r&&!g?{status:"half",value:.5}:t+1>=s&&r&&g?{status:"half",value:Math.round((t-s+1)*1e10)/1e10}:{status:"void",value:0}}const St={size:Y,icon:D("star"),color:String,count:nt(5),gutter:Y,readonly:Boolean,disabled:Boolean,voidIcon:D("star-o"),allowHalf:Boolean,voidColor:String,touchable:it,iconPrefix:String,modelValue:dt(0),disabledColor:String};var Vt=rt({name:Rt,props:St,emits:["change","update:modelValue"],setup(t,{emit:s}){const r=ct(),[g,l]=Ct(),m=ut(),p=()=>t.readonly||t.disabled||!t.touchable,y=ht(()=>Array(+t.count).fill("").map((o,a)=>wt(t.modelValue,a+1,t.allowHalf,t.readonly)));let d,v,e=Number.MAX_SAFE_INTEGER,c=Number.MIN_SAFE_INTEGER;const P=()=>{v=j(m);const o=g.value.map(j);d=[],o.forEach((a,i)=>{e=Math.min(a.top,e),c=Math.max(a.top,c),t.allowHalf?d.push({score:i+.5,left:a.left,top:a.top,height:a.height},{score:i+1,left:a.left+a.width/2,top:a.top,height:a.height}):d.push({score:i+1,left:a.left,top:a.top,height:a.height})})},T=(o,a)=>{for(let i=d.length-1;i>0;i--)if(a>=v.top&&a<=v.bottom){if(o>d[i].left&&a>=d[i].top&&a<=d[i].top+d[i].height)return d[i].score}else{const C=a<v.top?e:c;if(o>d[i].left&&d[i].top===C)return d[i].score}return t.allowHalf?.5:1},B=o=>{!t.disabled&&!t.readonly&&o!==t.modelValue&&(s("update:modelValue",o),s("change",o))},$=o=>{p()||(r.start(o),P())},tt=o=>{if(!p()&&(r.move(o),r.isHorizontal())){const{clientX:a,clientY:i}=o.touches[0];mt(o),B(T(a,i))}},et=(o,a)=>{const{icon:i,size:C,color:E,count:z,gutter:H,voidIcon:x,disabled:k,voidColor:F,allowHalf:M,iconPrefix:q,disabledColor:A}=t,S=a+1,V=o.status==="full",R=o.status==="void",at=M&&o.value>0&&o.value<1;let X;H&&S!==+z&&(X={paddingRight:gt(H)});const st=U=>{P(),B(M?T(U.clientX,U.clientY):S)};return _("div",{key:a,ref:l(a),role:"radio",style:X,class:w("item"),tabindex:k?void 0:0,"aria-setsize":z,"aria-posinset":S,"aria-checked":!R,onClick:st},[_(G,{size:C,name:V?i:x,class:w("icon",{disabled:k,full:V}),color:k?A:V?E:F,classPrefix:q},null),at&&_(G,{size:C,style:{width:o.value+"em"},name:R?x:i,class:w("icon",["half",{disabled:k,full:!R}]),color:k?A:R?F:E,classPrefix:q},null)])};return _t(()=>t.modelValue),ft("touchmove",tt,{target:m}),()=>_("div",{ref:m,role:"radiogroup",class:w({readonly:t.readonly,disabled:t.disabled}),tabindex:t.disabled?void 0:0,"aria-disabled":t.disabled,"aria-readonly":t.readonly,onTouchstartPassive:$},[y.value.map(et)])}});const It=pt(Vt),Nt={props:["num"],components:{Rate:It},data(){return{resnum:this.num/2}}};function Pt(t,s,r,g,l,m){const p=L("Rate",!0);return u(),h("div",null,[_(p,{modelValue:l.resnum,"onUpdate:modelValue":s[0]||(s[0]=y=>l.resnum=y),readonly:"","allow-half":""},null,8,["modelValue"])])}const Tt=O(Nt,[["render",Pt]]);const Bt={name:"allhot",components:{headnav:ot,rate:Tt,List:vt},data(){return{ageList:[],classList:[],hotList:[],loading:!1,finished:!1,page:2,data:{ageid:"",cateid:"",listtype:0}}},async created(){let{data:t}=await yt();this.ageList=t.data.age,this.ageList.unshift({attr_name:"\u5168\u5E74\u9F84",attr_val_id:""}),this.classList=t.data.category,this.classList.unshift({category_id:"",category_name:"\u5168\u90E8\u5206\u7C7B"});let s=this.$route.query.id;s&&(this.data.ageid=s)},methods:{async onLoad(){let{data:t}=await J(this.data.cateid,this.data.ageid,this.data.listtype,this.page);this.page+=1,t.data.list.length==0?this.finished=!0:this.hotList.push(...t.data.list),this.loading=!1}},watch:{data:{async handler(t,s){let{data:r}=await J(t.cateid,t.ageid,t.listtype,1);this.hotList=r.data.list},immediate:!0,deep:!0}}},W=t=>(bt("data-v-d1d6dfe7"),t=t(),Lt(),t),Et={class:"box"},zt=["onClick"],Ht=["onClick"],xt={class:"del"},Ft={class:"nav"},Mt={class:"cont"},qt=["src"],At={class:"text"},Xt={key:0},Ut=W(()=>n("span",null,"\u{1F81D}",-1)),Yt={key:1},Dt=W(()=>n("span",null,"\u{1F81F}",-1));function Gt(t,s,r,g,l,m){const p=L("headnav"),y=L("rate"),d=L("router-link"),v=L("List");return u(),h("div",null,[_(p,{title:"\u8BE6\u7EC6\u699C\u5355"}),n("div",Et,[n("ul",null,[(u(!0),h(I,null,N(l.ageList,e=>(u(),h("li",{key:e.attr_val_id,onClick:c=>l.data.ageid=e.attr_val_id,class:b(e.attr_val_id==l.data.ageid?"active":"")},[n("p",null,f(e.attr_name),1)],10,zt))),128))]),n("ul",null,[(u(!0),h(I,null,N(l.classList,e=>(u(),h("li",{key:e.category_id,onClick:c=>l.data.cateid=e.category_id,class:b(e.category_id==l.data.cateid?"active":"")},[n("p",null,f(e.category_name),1)],10,Ht))),128))])]),n("div",xt,[n("div",Ft,[n("p",{onClick:s[0]||(s[0]=e=>l.data.listtype=0),class:b(l.data.listtype==0?"active":"")}," \u6708\u603B\u699C ",2),n("p",{onClick:s[1]||(s[1]=e=>l.data.listtype=1),class:b(l.data.listtype==1?"active":"")}," \u6708\u4E0A\u5347\u699C ",2)]),n("div",Mt,[n("ul",null,[_(v,{loading:l.loading,"onUpdate:loading":s[2]||(s[2]=e=>l.loading=e),finished:l.finished,"finished-text":"\u6CA1\u6709\u66F4\u591A\u4E86",onLoad:m.onLoad},{default:K(()=>[(u(!0),h(I,null,N(l.hotList,(e,c)=>(u(),kt(d,{key:e.goods_id,to:"/goodbookdet?goodbookid="+e.goods_id},{default:K(()=>[n("li",null,[n("p",{class:b(c<3?"active":"")},f(c+1<10?"0"+(c+1):c),3),n("img",{src:e.goods_thumb,alt:""},null,8,qt),n("div",At,[n("p",null,f(e.goods_name),1),n("p",null,[_(y,{num:e.avg_score},null,8,["num"]),n("span",null,f(e.avg_score),1)]),e.rising_ranking>0?(u(),h("p",Xt,[Q(" \u4E0A\u5347"+f(e.rising_ranking)+"\u4F4D",1),Ut])):Z("",!0),e.rising_ranking<0?(u(),h("p",Yt,[Q(" \u4E0B\u964D"+f(-e.rising_ranking)+"\u4F4D",1),Dt])):Z("",!0)])])]),_:2},1032,["to"]))),128))]),_:1},8,["loading","finished","onLoad"])])])])])}const Qt=O(Bt,[["render",Gt],["__scopeId","data-v-d1d6dfe7"]]);export{Qt as default};
